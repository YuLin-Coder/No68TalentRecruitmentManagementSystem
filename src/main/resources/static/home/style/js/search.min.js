$(function(){$(window).resize(function(){var a=$("#search_box").offset().left+96;$(".ui-autocomplete").css("left",a)}),$(".ui-autocomplete").css("height","200px"),$.widget("custom.catcomplete",$.ui.autocomplete,{_renderItem:function(a,b){var c=b.count>=600?"大于":"共";return $("<li></li>").data("item.autocomplete",b).append("<a><span class='fl'>"+b.name+"</span><span class='fr'>"+c+"<i>"+b.count+"个</i>职位</span></a>").appendTo(a)},_renderMenu:function(a,b){var c=this,d="";$.each(b,function(b,e){e.category!=d&&(a.append("<li class='ui-autocomplete-category'>"+e.category+"</li>"),d=e.category),c._renderItemData(a,e)}),a.find(".ui-autocomplete-category:not(:first-child)").next().css("borderTop","1px dashed #e5e5e5"),a.find(".ui-autocomplete-category").first().css("borderTop","none")}}),$("#search_input").catcomplete({minLength:0,source:function(a,b){""!=$.trim(a.term)?$.ajax({url:ctx+"/suggest.json",dataType:"json",data:{query:a.term},success:function(a){var f,c=new Array,d="",e=["职位","公司","城市"];for(f=0;f<a.content.length;f++)$.each(a.content[f],function(a,b){d='{"name":"'+b.name+'","count":"'+b.count+'","type":"'+b.type+'","category":"'+e[f]+'"}',d=jQuery.parseJSON(d),c.push(d)});b(c)}}):b("")},focus:function(){return!1},select:function(a,b){$("#search_input").val(b.item.name);var c=encodeURIComponent(b.item.name);return $("#searchForm").attr("action",ctx+"/jobs/list_"+c),$("#search_button").trigger("click",b.item.type),!1}}),$("#search_button").click(function(a,b){var c,d,e;b&&$("#spcInput").val(b),c=$.trim($("#search_input").val()),("请输入职位名称，如：产品经理"==c||"请输入公司名称，如：拉勾"==c)&&(c=""),d=/[\\\/]/g,e=c.replace(d," "),e=encodeURIComponent(e),$("#labelWords").val(""),""==e?$("#searchForm").attr("action",ctx+"/jobs/list_所有职位").submit():$("#searchForm").attr("action",ctx+"/jobs/list_"+e).submit()}),$("#searchType").hover(function(){$(this).children("li").show(),$(this).siblings(".searchtype_arrow").addClass("transform")},function(){$(this).children("li").not(".type_selected").hide(),$(this).siblings(".searchtype_arrow").removeClass("transform")}),$("#searchType li").click(function(){$(this).siblings("li").hide(),$(this).hasClass("type_selected")||($("#searchType li").removeClass("type_selected"),$(this).addClass("type_selected").prependTo("#searchType"));var b=$(this).attr("data-searchtype");1==b?($("#search_input").attr("placeholder","请输入职位名称，如：产品经理"),$(".placeholder").val("请输入职位名称，如：产品经理")):($("#search_input").attr("placeholder","请输入公司名称，如：拉勾"),$(".placeholder").val("请输入公司名称，如：拉勾")),$("#spcInput").val(b),$(this).children("li").not(".type_selected").hide(),$(this).siblings(".searchtype_arrow").removeClass("transform")}),$("#searchForm").submit(function(){var a=$("#search_input").val(),b=/[\\\/]/g;return a=a.replace(b," "),a=encodeURIComponent(a),$(this).attr("action",ctx+"/jobs/list_"+a),!0})});